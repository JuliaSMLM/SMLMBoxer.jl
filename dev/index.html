<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · SMLMBoxer.jl</title><meta name="title" content="Home · SMLMBoxer.jl"/><meta property="og:title" content="Home · SMLMBoxer.jl"/><meta property="twitter:title" content="Home · SMLMBoxer.jl"/><meta name="description" content="Documentation for SMLMBoxer.jl."/><meta property="og:description" content="Documentation for SMLMBoxer.jl."/><meta property="twitter:description" content="Documentation for SMLMBoxer.jl."/><meta property="og:url" content="https://JuliaSMLM.github.io/SMLMBoxer.jl/"/><meta property="twitter:url" content="https://JuliaSMLM.github.io/SMLMBoxer.jl/"/><link rel="canonical" href="https://JuliaSMLM.github.io/SMLMBoxer.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>SMLMBoxer.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/main/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SMLMBoxer"><a class="docs-heading-anchor" href="#SMLMBoxer">SMLMBoxer</a><a id="SMLMBoxer-1"></a><a class="docs-heading-anchor-permalink" href="#SMLMBoxer" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/JuliaSMLM/SMLMBoxer.jl">SMLMBoxer</a>.</p><ul><li><a href="#SMLMBoxer._getboxes_impl-Tuple{SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer._getboxes_impl</code></a></li><li><a href="#SMLMBoxer.convolve-Tuple{AbstractArray{&lt;:Real}, Matrix{Float32}}"><code>SMLMBoxer.convolve</code></a></li><li><a href="#SMLMBoxer.convolve_variance_weighted-Union{Tuple{T}, Tuple{AbstractArray{T}, AbstractMatrix{T}, Float32, Bool}} where T&lt;:Real"><code>SMLMBoxer.convolve_variance_weighted</code></a></li><li><a href="#SMLMBoxer.dog_filter-Tuple{AbstractArray{&lt;:Real}, SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer.dog_filter</code></a></li><li><a href="#SMLMBoxer.dog_filter_variance_weighted-Tuple{AbstractArray{&lt;:Real}, Real, Real, SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer.dog_filter_variance_weighted</code></a></li><li><a href="#SMLMBoxer.dog_kernel-Tuple{Float32, Float32}"><code>SMLMBoxer.dog_kernel</code></a></li><li><a href="#SMLMBoxer.extract_camera_roi-Union{Tuple{T}, Tuple{SMLMData.IdealCamera{T}, Any, Any}} where T"><code>SMLMBoxer.extract_camera_roi</code></a></li><li><a href="#SMLMBoxer.fillbox!-Tuple{AbstractMatrix{&lt;:Real}, AbstractArray{&lt;:Real, 4}, Vararg{Int64, 4}}"><code>SMLMBoxer.fillbox!</code></a></li><li><a href="#SMLMBoxer.findlocalmax-Tuple{AbstractArray{&lt;:Real}, Int64}"><code>SMLMBoxer.findlocalmax</code></a></li><li><a href="#SMLMBoxer.gaussian_2d-Tuple{Float32, Int64}"><code>SMLMBoxer.gaussian_2d</code></a></li><li><a href="#SMLMBoxer.genlocalmaximage-Tuple{AbstractArray{&lt;:Real}, Int64}"><code>SMLMBoxer.genlocalmaximage</code></a></li><li><a href="#SMLMBoxer.get_variance_map-Union{Tuple{T}, Tuple{SMLMData.IdealCamera{T}, Tuple{Int64, Int64}}} where T"><code>SMLMBoxer.get_variance_map</code></a></li><li><a href="#SMLMBoxer.getboxes"><code>SMLMBoxer.getboxes</code></a></li><li><a href="#SMLMBoxer.getboxstack-Tuple{Any, Any, SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer.getboxstack</code></a></li><li><a href="#SMLMBoxer.maxima2coords-Tuple{AbstractArray{Float32}}"><code>SMLMBoxer.maxima2coords</code></a></li><li><a href="#SMLMBoxer.pixels_to_microns-Tuple{AbstractMatrix, SMLMData.AbstractCamera}"><code>SMLMBoxer.pixels_to_microns</code></a></li><li><a href="#SMLMBoxer.removeoverlap-Tuple{Vector{Matrix{Float32}}, SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer.removeoverlap</code></a></li><li><a href="#SMLMBoxer.reshape_for_flux-Tuple{AbstractArray{&lt;:Real}}"><code>SMLMBoxer.reshape_for_flux</code></a></li><li><a href="#SMLMBoxer.variance_weighted_gaussian_kernel!-Tuple{Any}"><code>SMLMBoxer.variance_weighted_gaussian_kernel!</code></a></li></ul><article><details class="docstring" open="true"><summary id="SMLMBoxer._getboxes_impl-Tuple{SMLMBoxer.GetBoxesArgs}"><a class="docstring-binding" href="#SMLMBoxer._getboxes_impl-Tuple{SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer._getboxes_impl</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">_getboxes_impl(args::GetBoxesArgs)</code></pre><p>Internal implementation of getboxes that does the actual work.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/interface.jl#L82-L86">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.convolve-Tuple{AbstractArray{&lt;:Real}, Matrix{Float32}}"><a class="docstring-binding" href="#SMLMBoxer.convolve-Tuple{AbstractArray{&lt;:Real}, Matrix{Float32}}"><code>SMLMBoxer.convolve</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">convolve(imagestack, kernel; use_gpu=false)</code></pre><p>Convolve imagestack with given kernel.</p><p><strong>Arguments</strong></p><ul><li><code>imagestack</code>: Input array of image data</li><li><code>kernel</code>: Kernel to convolve with </li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>use_gpu</code>: Whether to use GPU </li></ul><p><strong>Returns</strong></p><ul><li><code>filtered_stack</code>: Convolved image stack</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/filter.jl#L261-L275">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.convolve_variance_weighted-Union{Tuple{T}, Tuple{AbstractArray{T}, AbstractMatrix{T}, Float32, Bool}} where T&lt;:Real"><a class="docstring-binding" href="#SMLMBoxer.convolve_variance_weighted-Union{Tuple{T}, Tuple{AbstractArray{T}, AbstractMatrix{T}, Float32, Bool}} where T&lt;:Real"><code>SMLMBoxer.convolve_variance_weighted</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">convolve_variance_weighted(imagestack, variance_map, sigma, use_gpu)</code></pre><p>Apply variance-weighted Gaussian convolution using KernelAbstractions. Device-agnostic: works on CPU and GPU with same code.</p><p><strong>Arguments</strong></p><ul><li><code>imagestack</code>: Input image (rows, cols, 1, frames)</li><li><code>variance_map</code>: Variance at each pixel (rows, cols)</li><li><code>sigma</code>: Gaussian sigma</li><li><code>use_gpu</code>: Use GPU if available</li></ul><p><strong>Returns</strong></p><ul><li>Variance-weighted filtered image</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/filter.jl#L198-L212">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.dog_filter-Tuple{AbstractArray{&lt;:Real}, SMLMBoxer.GetBoxesArgs}"><a class="docstring-binding" href="#SMLMBoxer.dog_filter-Tuple{AbstractArray{&lt;:Real}, SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer.dog_filter</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">dog_filter(imagestack, args)</code></pre><p>Apply DoG filter to imagestack based on args. Uses variance-weighted filtering if sCMOS camera is provided.</p><p><strong>Arguments</strong></p><ul><li><code>imagestack</code>: Input array of image data</li><li><code>args</code>: Arguments with sigma values and camera</li></ul><p><strong>Returns</strong></p><ul><li><code>filtered_stack</code>: Filtered image stack</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/filter.jl#L75-L87">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.dog_filter_variance_weighted-Tuple{AbstractArray{&lt;:Real}, Real, Real, SMLMBoxer.GetBoxesArgs}"><a class="docstring-binding" href="#SMLMBoxer.dog_filter_variance_weighted-Tuple{AbstractArray{&lt;:Real}, Real, Real, SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer.dog_filter_variance_weighted</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">dog_filter_variance_weighted(imagestack, sigma_small, sigma_large, args)</code></pre><p>Apply variance-weighted DoG filter using sCMOS variance map. Implements SMITE-style inverse variance weighting during convolution.</p><p><strong>Arguments</strong></p><ul><li><code>imagestack</code>: Input image data (rows, cols, 1, frames)</li><li><code>sigma_small</code>: Sigma for small Gaussian</li><li><code>sigma_large</code>: Sigma for large Gaussian</li><li><code>args</code>: GetBoxesArgs with camera</li></ul><p><strong>Returns</strong></p><ul><li><code>filtered_stack</code>: Variance-weighted filtered image</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/filter.jl#L106-L120">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.dog_kernel-Tuple{Float32, Float32}"><a class="docstring-binding" href="#SMLMBoxer.dog_kernel-Tuple{Float32, Float32}"><code>SMLMBoxer.dog_kernel</code></a> — <span class="docstring-category">Method</span></summary><div><p>dog_kernel(s1, s2)</p><p>Compute difference of Gaussian kernels.   </p><p><strong>Arguments</strong></p><ul><li><code>sigma_small</code>: Sigma for small Gaussian </li><li><code>sigma_large</code>: Sigma for large Gaussian</li></ul><p><strong>Returns</strong></p><ul><li><code>dog</code>: Difference of Gaussians kernel</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/filter.jl#L52-L64">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.extract_camera_roi-Union{Tuple{T}, Tuple{SMLMData.IdealCamera{T}, Any, Any}} where T"><a class="docstring-binding" href="#SMLMBoxer.extract_camera_roi-Union{Tuple{T}, Tuple{SMLMData.IdealCamera{T}, Any, Any}} where T"><code>SMLMBoxer.extract_camera_roi</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">extract_camera_roi(camera::AbstractCamera, row_range, col_range)</code></pre><p>Extract a camera ROI with calibration data for the specified pixel region.</p><p><strong>Arguments</strong></p><ul><li><code>camera</code>: Source camera object</li><li><code>row_range</code>: Range of rows to extract</li><li><code>col_range</code>: Range of columns to extract</li></ul><p><strong>Returns</strong></p><ul><li>Camera object of the same type with ROI calibration data</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/types.jl#L41-L53">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.fillbox!-Tuple{AbstractMatrix{&lt;:Real}, AbstractArray{&lt;:Real, 4}, Vararg{Int64, 4}}"><a class="docstring-binding" href="#SMLMBoxer.fillbox!-Tuple{AbstractMatrix{&lt;:Real}, AbstractArray{&lt;:Real, 4}, Vararg{Int64, 4}}"><code>SMLMBoxer.fillbox!</code></a> — <span class="docstring-category">Method</span></summary><div><p>fillbox!(box, imagestack, row, col, im, boxsize)</p><p>Fill a box with a crop from the imagestack.</p><p><strong>Arguments</strong></p><ul><li><code>box</code>: Array to fill with box crop</li><li><code>imagestack</code>: Input image stack </li><li><code>row</code>, <code>col</code>, <code>im</code>: Coords for crop</li><li><code>boxsize</code>: Size of box</li></ul><p><strong>Returns</strong></p><ul><li><code>boxcoords</code>: Upper Left corners of boxes N x (row, col, im)</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/boxes.jl#L49-L62">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.findlocalmax-Tuple{AbstractArray{&lt;:Real}, Int64}"><a class="docstring-binding" href="#SMLMBoxer.findlocalmax-Tuple{AbstractArray{&lt;:Real}, Int64}"><code>SMLMBoxer.findlocalmax</code></a> — <span class="docstring-category">Method</span></summary><div><p><strong>findlocalmax(imagestack, kernelsize; minval=0.0, use_gpu=false)</strong></p><p>Find the coordinates of local maxima in an image.</p><p><strong>Arguments</strong></p><ul><li><code>imagestack</code>: An array of real numbers representing the image data.</li><li><code>kernelsize</code>: The size of the kernel used to identify local maxima.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>minval</code>: The minimum value a local maximum must have to be considered valid (default: 0.0).</li><li><code>use_gpu</code>: Whether or not to use GPU acceleration (default: false).</li></ul><p><strong>Returns</strong></p><ul><li><code>coords</code>: The coordinates of the local maxima in the image.</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/localmax.jl#L27-L42">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.gaussian_2d-Tuple{Float32, Int64}"><a class="docstring-binding" href="#SMLMBoxer.gaussian_2d-Tuple{Float32, Int64}"><code>SMLMBoxer.gaussian_2d</code></a> — <span class="docstring-category">Method</span></summary><div><p>gaussian_2d(sigma, ksize)</p><p>Create a 2D Gaussian kernel.</p><p><strong>Arguments</strong></p><ul><li><code>sigma</code>: Standard deviation</li><li><code>kernelsize</code>: Kernel size</li></ul><p><strong>Returns</strong></p><ul><li><code>kernel</code>: Normalized 2D Gaussian kernel  </li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/filter.jl#L26-L37">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.genlocalmaximage-Tuple{AbstractArray{&lt;:Real}, Int64}"><a class="docstring-binding" href="#SMLMBoxer.genlocalmaximage-Tuple{AbstractArray{&lt;:Real}, Int64}"><code>SMLMBoxer.genlocalmaximage</code></a> — <span class="docstring-category">Method</span></summary><div><p><strong>genlocalmaximage(imagestack, kernelsize; minval=0.0, use_gpu=false)</strong></p><p>Generate an image highlighting the local maxima.</p><p><strong>Arguments</strong></p><ul><li><code>imagestack</code>: An array of real numbers representing the image data.</li><li><code>kernelsize</code>: The size of the kernel used to identify local maxima.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>minval</code>: The minimum value a local maximum must have to be considered valid (default: 0.0).</li><li><code>use_gpu</code>: Whether or not to use GPU acceleration (default: false).</li></ul><p><strong>Returns</strong></p><ul><li><code>localmaximage</code>: An image with local maxima highlighted.</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/localmax.jl#L1-L16">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.get_variance_map-Union{Tuple{T}, Tuple{SMLMData.IdealCamera{T}, Tuple{Int64, Int64}}} where T"><a class="docstring-binding" href="#SMLMBoxer.get_variance_map-Union{Tuple{T}, Tuple{SMLMData.IdealCamera{T}, Tuple{Int64, Int64}}} where T"><code>SMLMBoxer.get_variance_map</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">get_variance_map(camera::AbstractCamera, imagesize)</code></pre><p>Compute variance map from camera calibration.</p><p><strong>Arguments</strong></p><ul><li><code>camera</code>: Camera object with noise calibration</li><li><code>imagesize</code>: Tuple of (nrows, ncols) for the image</li></ul><p><strong>Returns</strong></p><ul><li>Variance map (variance = readnoise²) matching image dimensions</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/types.jl#L78-L89">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.getboxes"><a class="docstring-binding" href="#SMLMBoxer.getboxes"><code>SMLMBoxer.getboxes</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">getboxes(imagestack, camera=nothing; kwargs...) -&gt; ROIBatch</code></pre><p>Detect particles/blobs in a multidimensional image stack and return ROI batch with location tracking.</p><p><strong>Arguments</strong></p><ul><li><code>imagestack::AbstractArray{&lt;:Real}</code>: The input image stack. Should be 2D or 3D.</li><li><code>camera::Union{AbstractCamera,Nothing}</code>: Optional camera object (IdealCamera or SCMOSCamera) from SMLMData. If not provided, a default IdealCamera is created.</li><li><code>boxsize::Int</code>: Size of the box to cut out around each local maximum (pixels).</li><li><code>overlap::Real</code>: Amount of overlap allowed between boxes (pixels).</li><li><code>sigma_small::Real</code>: Sigma for small Gaussian blur kernel (pixels).</li><li><code>sigma_large::Real</code>: Sigma for large Gaussian blur kernel (pixels).</li><li><code>minval::Real</code>: Minimum value to consider as a local maximum.</li><li><code>use_gpu::Bool</code>: Perform convolution and local max finding on GPU.</li></ul><p><strong>Returns</strong></p><p><code>ROIBatch</code> with the following fields:</p><ul><li><code>data</code>: ROI stack (boxsize × boxsize × n_rois) containing image patches</li><li><code>corners</code>: (2 × n_rois) matrix of (x,y) = (col,row) corner positions in camera coordinates</li><li><code>frame_indices</code>: Vector of frame indices for each ROI</li><li><code>camera</code>: Camera object (provided or default IdealCamera)</li><li><code>roi_size</code>: Size of each ROI (square)</li></ul><p><strong>Details on filtering</strong></p><p>The image stack is convolved with a difference of Gaussians (DoG) filter to identify blobs and local maxima. The DoG is computed from two Gaussian kernels with standard deviations <code>sigma_small</code> and <code>sigma_large</code>.</p><p><strong>Variance-Weighted Filtering (sCMOS)</strong></p><p>When an SCMOSCamera is provided, the package uses <strong>variance-weighted filtering</strong> based on the SMITE algorithm. Each pixel&#39;s contribution to the convolution is weighted by:</p><pre><code class="language-julia hljs">weight = gaussian_kernel / variance</code></pre><p>where variance = readnoise². This implements optimal inverse variance weighting:</p><ul><li>Low-noise pixels receive high weight (strong influence on detection)</li><li>High-noise pixels receive low weight (reduced influence, avoiding false positives)</li></ul><p>This significantly improves detection sensitivity in sCMOS data with spatially-varying noise.</p><p><strong>GPU Acceleration:</strong> Variance-weighted filtering uses KernelAbstractions.jl for device-agnostic computation. The same kernel code runs on both CPU and GPU, automatically selected based on <code>use_gpu</code>. This provides GPU acceleration for sCMOS cameras (10-100x speedup on large images).</p><p><strong>Standard Filtering (IdealCamera or no camera)</strong></p><p>Standard DoG convolution is used when no camera is provided or with IdealCamera. The convolution is performed via Flux/cuDNN on GPU or CPU, depending on <code>use_gpu</code>.</p><p>After filtering, local maxima above <code>minval</code> are identified. Boxes are cut out around each maximum, excluding overlaps.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Basic usage
roi_batch = getboxes(imagestack; boxsize=7, overlap=2.0, sigma_small=1.0, sigma_large=2.0)
boxes = roi_batch.data  # (7 × 7 × n_rois)
corners = roi_batch.corners  # (2 × n_rois) [x;y] = [col;row]
frames = roi_batch.frame_indices

# With camera for proper coordinate system
camera = IdealCamera(1:256, 1:256, 0.1f0)  # npixels_x, npixels_y, pixel_size
roi_batch = getboxes(imagestack, camera; boxsize=7, overlap=2.0)

# Iterate over ROIs
for roi in roi_batch
    # roi is a SingleROI with .data, .corner, .frame_idx
    process(roi.data)
end</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/interface.jl#L1-L75">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.getboxstack-Tuple{Any, Any, SMLMBoxer.GetBoxesArgs}"><a class="docstring-binding" href="#SMLMBoxer.getboxstack-Tuple{Any, Any, SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer.getboxstack</code></a> — <span class="docstring-category">Method</span></summary><div><p>getboxstack(imagestack, coords, args::GetBoxesArgs)</p><p>Cut out box regions from imagestack centered on coords.</p><p><strong>Arguments</strong></p><ul><li><code>imagestack</code>: Input image stack</li><li><code>coords</code>: Coords of box centers</li><li><code>args</code>: Parameters</li></ul><p><strong>Returns</strong></p><ul><li><code>boxstack</code>: Array with box crops from imagestack</li><li><code>boxcoords</code>: Upper left corners of boxes</li><li><code>camera_rois</code>: Camera ROIs for each box (if camera provided)</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/boxes.jl#L1-L15">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.maxima2coords-Tuple{AbstractArray{Float32}}"><a class="docstring-binding" href="#SMLMBoxer.maxima2coords-Tuple{AbstractArray{Float32}}"><code>SMLMBoxer.maxima2coords</code></a> — <span class="docstring-category">Method</span></summary><div><p>maxima2coords(imagestack)</p><p>Get coordinates of all non-zero pixels in input stack </p><p><strong>Arguments</strong></p><ul><li><code>imagestack</code>: Input image stack</li></ul><p><strong>Returns</strong></p><ul><li><code>coords</code>: List of coords for each frame</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/coords.jl#L1-L12">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.pixels_to_microns-Tuple{AbstractMatrix, SMLMData.AbstractCamera}"><a class="docstring-binding" href="#SMLMBoxer.pixels_to_microns-Tuple{AbstractMatrix, SMLMData.AbstractCamera}"><code>SMLMBoxer.pixels_to_microns</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">pixels_to_microns(pixel_coords, camera::AbstractCamera)</code></pre><p>Convert pixel coordinates (row, col) to micron coordinates (x, y) using camera geometry.</p><p><strong>Arguments</strong></p><ul><li><code>pixel_coords</code>: N×2 matrix of (row, col) coordinates</li><li><code>camera</code>: Camera object with pixel<em>edges</em>x and pixel<em>edges</em>y</li></ul><p><strong>Returns</strong></p><ul><li>N×2 matrix of (x, y) coordinates in microns</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/types.jl#L12-L23">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.removeoverlap-Tuple{Vector{Matrix{Float32}}, SMLMBoxer.GetBoxesArgs}"><a class="docstring-binding" href="#SMLMBoxer.removeoverlap-Tuple{Vector{Matrix{Float32}}, SMLMBoxer.GetBoxesArgs}"><code>SMLMBoxer.removeoverlap</code></a> — <span class="docstring-category">Method</span></summary><div><p>removeoverlap(coords, args)</p><p>Remove overlapping coords based on distance.</p><p><strong>Arguments</strong></p><ul><li><code>coords</code>: List of coords</li><li><code>args</code>: Parameters  </li></ul><p><strong>Returns</strong></p><ul><li><code>coords</code>: Coords with overlaps removed </li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/coords.jl#L39-L50">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.reshape_for_flux-Tuple{AbstractArray{&lt;:Real}}"><a class="docstring-binding" href="#SMLMBoxer.reshape_for_flux-Tuple{AbstractArray{&lt;:Real}}"><code>SMLMBoxer.reshape_for_flux</code></a> — <span class="docstring-category">Method</span></summary><div><p>reshape<em>for</em>flux(arr::AbstractArray)</p><p>Reshape array to have singleton dims for Flux.jl convolution.  </p><p><strong>Arguments</strong></p><ul><li><code>arr</code>: Input array, must be 2D or 3D</li></ul><p><strong>Returns</strong></p><ul><li>Reshaped array with added singleton dimensions</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/filter.jl#L1-L11">source</a></div></details></article><article><details class="docstring" open="true"><summary id="SMLMBoxer.variance_weighted_gaussian_kernel!-Tuple{Any}"><a class="docstring-binding" href="#SMLMBoxer.variance_weighted_gaussian_kernel!-Tuple{Any}"><code>SMLMBoxer.variance_weighted_gaussian_kernel!</code></a> — <span class="docstring-category">Method</span></summary><div><pre><code class="language-julia hljs">variance_weighted_gaussian_kernel!(output, input, variance, sigma, winsize)</code></pre><p>KernelAbstractions kernel for variance-weighted Gaussian convolution. Implements SMITE-style inverse variance weighting.</p><p>This follows the same KernelAbstractions pattern used in GaussMLE.jl (kernel-abstract branch) for seamless CPU/GPU execution and consistent API across JuliaSMLM packages.</p><p><strong>Arguments</strong></p><ul><li><code>output</code>: Output array (nrows, ncols)</li><li><code>input</code>: Input array (nrows, ncols)</li><li><code>variance</code>: Variance map (nrows, ncols)</li><li><code>sigma</code>: Gaussian sigma</li><li><code>winsize</code>: Window size (pixels)</li></ul><p><strong>Note</strong></p><p>Same kernel code runs on CPU (via CPU() backend) or GPU (via CUDABackend()). Backend is selected automatically based on use_gpu parameter.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMBoxer.jl/blob/d8b5be4e90f463d3b95a9f7bd266225d8249b4a3/src/filter.jl#L145-L164">source</a></div></details></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Tuesday 18 November 2025 19:36">Tuesday 18 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
